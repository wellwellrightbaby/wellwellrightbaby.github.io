<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ThinkPhp | Shevon&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要:thinkphp">
<meta name="keywords">
<meta property="og:type" content="article">
<meta property="og:title" content="ThinkPhp">
<meta property="og:url" content="https://wellwellrightbaby.github.io/2017/04/25/thinkphp/index.html">
<meta property="og:site_name" content="Shevon's Blog">
<meta property="og:description" content="摘要:thinkphp">
<meta property="og:updated_time" content="2017-05-05T06:32:02.914Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ThinkPhp">
<meta name="twitter:description" content="摘要:thinkphp">
  
    <link rel="alternate" href="/atom.xml" title="Shevon&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Shevon&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Fighting in my all life</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://wellwellrightbaby.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-thinkphp" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/25/thinkphp/" class="article-date">
  <time datetime="2017-04-24T23:36:57.336Z" itemprop="datePublished">2017-04-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/ThinkPhp/">ThinkPhp</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      ThinkPhp
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>摘要:thinkphp<br><a id="more"></a><br>正文:</p>
<p>[TOC]<br><a href="http://www.kancloud.cn/manual/thinkphp/1678" target="_blank" rel="external">ThinkPHP3.2.3完全开发手册</a></p>
<h2 id="一-ThinkPHP-框架系统目录"><a href="#一-ThinkPHP-框架系统目录" class="headerlink" title="一.ThinkPHP 框架系统目录"></a>一.ThinkPHP 框架系统目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">├─ThinkPHP 框架系统目录（可以部署在非web目录下面）</div><div class="line">│  ├─Common       核心公共函数目录</div><div class="line">│  ├─Conf         核心配置目录 </div><div class="line">│  ├─Lang         核心语言包目录</div><div class="line">│  ├─Library      框架类库目录</div><div class="line">│  │  ├─Think     核心Think类库包目录</div><div class="line">│  │  ├─Behavior  行为类库目录</div><div class="line">│  │  ├─Org       Org类库包目录</div><div class="line">│  │  ├─Vendor    第三方类库目录</div><div class="line">│  │  ├─ ...      更多类库目录</div><div class="line">│  ├─Mode         框架应用模式目录</div><div class="line">│  ├─Tpl          系统模板目录</div><div class="line">│  ├─LICENSE.txt  框架授权协议文件</div><div class="line">│  ├─logo.png     框架LOGO文件</div><div class="line">│  ├─README.txt   框架README文件</div><div class="line">│  └─ThinkPHP.php 框架入口文件</div></pre></td></tr></table></figure>
<h2 id="二-定义入口文件"><a href="#二-定义入口文件" class="headerlink" title="二.定义入口文件"></a>二.定义入口文件</h2><p>如果你改变了项目目录（例如把Application更改为Apps），只需要在入口文件更改APP_PATH常量定义即可：</p>
<p>define(‘APP_PATH’,’./Apps/‘);<br>require ‘./ThinkPHP/ThinkPHP.php’;</p>
<p>和APP_PATH一样THINK_PATH路径定义也必须以“/”结尾。<br>给THINK_PATH和APP_PATH定义绝对路径会提高系统的加载效率。</p>
<h2 id="三-第一次访问应用入口文件时"><a href="#三-第一次访问应用入口文件时" class="headerlink" title="三.第一次访问应用入口文件时"></a>三.第一次访问应用入口文件时</h2><p>在第一次访问应用入口文件的时候，会显示如图所示的默认的欢迎页面，并自动生成了一个默认的应用模块Home。</p>
<p>接下来再看原来空的Application目录下面，已经自动生成了公共模块Common、默认的Home模块和Runtime运行时目录的目录结构：</p>
<p>Application<br>├─Common         应用公共模块<br>│  ├─Common      应用公共函数目录<br>│  └─Conf        应用公共配置文件目录<br>├─Home           默认生成的Home模块<br>│  ├─Conf        模块配置文件目录<br>│  ├─Common      模块函数公共目录<br>│  ├─Controller  模块控制器目录<br>│  ├─Model       模块模型目录<br>│  └─View        模块视图文件目录<br>├─Runtime        运行时目录<br>│  ├─Cache       模版缓存目录<br>│  ├─Data        数据目录<br>│  ├─Logs        日志目录<br>│  └─Temp        缓存目录</p>
<h3 id="模块设计"><a href="#模块设计" class="headerlink" title="模块设计"></a>模块设计</h3><p>新版采用模块化的设计架构，下面是一个应用目录下面的模块目录结构，每个模块可以方便的卸载和部署，并且支持公共模块。</p>
<p>Application      默认应用目录（可以设置）<br>├─Common         公共模块（不能直接访问）<br>├─Home           前台模块<br>├─Admin          后台模块<br>├─…            其他更多模块<br>├─Runtime        默认运行时目录（可以设置）</p>
<p>每个模块是相对独立的，其目录结构如下：</p>
<p>├─Module         模块目录<br>│  ├─Conf        配置文件目录<br>│  ├─Common      公共函数目录<br>│  ├─Controller  控制器目录<br>│  ├─Model       模型目录<br>│  ├─Logic       逻辑目录（可选）<br>│  ├─Service     Service目录（可选）<br>│  … 更多分层目录可选<br>│  └─View        视图目录<br>由于采用多层的MVC机制，除了Conf和Common目录外，每个模块下面的目录结构可以根据需要灵活设置和添加，所以并不拘泥于上面展现的目录。</p>
<h3 id="控制器类"><a href="#控制器类" class="headerlink" title="控制器类"></a>控制器类</h3><p>IndexController控制器类的开头是命名空间定义：</p>
<p>namespace Home\Controller;<br>这是系统的规范要求，表示当前类是Home模块下的控制器类，命名空间和实际的控制器文件所在的路径是一致的，也就是说： Home\Controller\IndexController类 对应的控制器文件位于应用目录下面的 Home/Controller/IndexController.class.php，如果你改变了当前的模块名，那么这个控制器类的命名空间也需要随之修改。</p>
<h2 id="四-命名规范"><a href="#四-命名规范" class="headerlink" title="四.命名规范"></a>四.命名规范</h2><p>使用ThinkPHP开发的过程中应该尽量遵循下列命名规范：</p>
<p>` </p>
<ul>
<li>类文件都是以.class.php为后缀（这里是指的ThinkPHP内部使用的类库文件，不代表外部加载的类库文件），使用驼峰法命名，并且首字母大写，例如 DbMysql.class.php；</li>
<li>类的命名空间地址和所在的路径地址一致，例如 Home\Controller\UserController类所在的路径应该是 Application/Home/Controller/UserController.class.php；</li>
<li>确保文件的命名和调用大小写一致，是由于在类Unix系统上面，对大小写是敏感的（而ThinkPHP在调试模式下面，即使在Windows平台也会严格检查大小写）；</li>
<li>类名和文件名一致（包括上面说的大小写一致），例如 UserController类的文件命名是UserController.class.php， InfoModel类的文件名是InfoModel.class.php， 并且不同的类库的类命名有一定的规范；</li>
<li>函数、配置文件等其他类库文件之外的一般是以.php为后缀（第三方引入的不做要求）；</li>
<li>函数的命名使用小写字母和下划线的方式，例如 get_client_ip；</li>
<li>方法的命名使用驼峰法，并且首字母小写或者使用下划线“_”，例如 getUserName，_parseType，通常下划线开头的方法属于私有方法；</li>
<li>属性的命名使用驼峰法，并且首字母小写或者使用下划线“_”，例如 tableName、_instance，通常下划线开头的属性属于私有属性；</li>
<li>以双下划线“<strong>”打头的函数或方法作为魔法方法，例如 </strong>call 和 __autoload；</li>
<li>常量以大写字母和下划线命名，例如 HAS_ONE和 MANY_TO_MANY；</li>
<li>配置参数以大写字母和下划线命名，例如HTML_CACHE_ON；</li>
<li>语言变量以大写字母和下划线命名，例如MY_LANG，以下划线打头的语言变量通常用于系统语言变量，例如 _CLASS_NOT<em>EXIST</em>；</li>
<li>对变量的命名没有强制的规范，可以根据团队规范来进行；</li>
<li>ThinkPHP的模板文件默认是以.html 为后缀（可以通过配置修改）；</li>
<li>数据表和字段采用小写加下划线方式命名，并注意字段名不要以下划线开头，例如 think_user 表和 user_name字段是正确写法，类似 _username 这样的数据表字段可能会被过滤。</li>
<li>特例：在ThinkPHP里面，有一个函数命名的特例，就是单字母大写函数，这类函数通常是某些操作的快捷定义，或者有特殊的作用。例如：A、D、S、L 方法等等，他们有着特殊的含义，后面会有所了解。</li>
</ul>
<p>`</p>
<h2 id="五-开发建议"><a href="#五-开发建议" class="headerlink" title="五.开发建议"></a>五.开发建议</h2><p>在使用ThinkPHP进行开发的过程中，我们给出如下建议，会让你的开发变得更轻松：</p>
<p>遵循框架的命名规范和目录规范；<br>开发过程中尽量开启调试模式，及早发现问题；<br>多看看日志文件，查找隐患问题；<br>养成使用I函数获取输入变量的好习惯；<br>更新或者环境改变后遇到问题首要问题是清空Runtime目录；</p>
<h2 id="六-PHP数组定义"><a href="#六-PHP数组定义" class="headerlink" title="六.PHP数组定义"></a>六.PHP数组定义</h2><p>还可以在配置文件中可以使用二维数组来配置更多的信息，例如：</p>
<p>//项目配置文件<br>return array(<br>    ‘DEFAULT_MODULE’     =&gt; ‘Index’, //默认模块<br>    ‘URL_MODEL’          =&gt; ‘2’, //URL模式<br>    ‘SESSION_AUTO_START’ =&gt; true, //是否开启session<br>    ‘USER_CONFIG’        =&gt; array(<br>        ‘USER_AUTH’ =&gt; true,<br>        ‘USER_TYPE’ =&gt; 2,<br>    ),<br>    //更多配置参数<br>    //…<br>);</p>
<p>在ThinkPHP中，一般来说应用的配置文件是自动加载的，加载的顺序是：</p>
<p>惯例配置-&gt;应用配置-&gt;模式配置-&gt;调试配置-&gt;状态配置-&gt;模块配置-&gt;扩展配置-&gt;动态配置</p>
<p>以上是配置文件的加载顺序，因为后面的配置会覆盖之前的同名配置（在没有生效的前提下），所以配置的优先顺序从右到左。</p>
<p>下面说明下不同的配置文件的区别和位置：</p>
<h3 id="惯例配置"><a href="#惯例配置" class="headerlink" title="惯例配置"></a>惯例配置</h3><p>惯例重于配置是系统遵循的一个重要思想，框架内置有一个惯例配置文件（位于ThinkPHP/Conf/convention.php），按照大多数的使用对常用参数进行了默认配置。所以，对于应用的配置文件，往往只需要配置和惯例配置不同的或者新增的配置参数，如果你完全采用默认配置，甚至可以不需要定义任何配置文件。</p>
<p>建议仔细阅读下系统的惯例配置文件中的相关配置参数，了解下系统默认的配置参数。</p>
<h3 id="应用配置"><a href="#应用配置" class="headerlink" title="应用配置"></a>应用配置</h3><p>应用配置文件也就是调用所有模块之前都会首先加载的公共配置文件（默认位于Application/Common/Conf/config.php）。</p>
<p>如果更改了公共模块的名称的话，公共配置文件的位置也相应改变<br>模式配置（可选）</p>
<p>如果使用了普通应用模式之外的应用模式的话，还可以为应用模式（后面会有描述）单独定义配置文件，文件命名规范是： Application/Common/Conf/config_应用模式名称.php（仅在运行该模式下面才会加载）。</p>
<p>模式配置文件是可选的</p>
<h3 id="调试配置（可选）"><a href="#调试配置（可选）" class="headerlink" title="调试配置（可选）"></a>调试配置（可选）</h3><p>如果开启调试模式的话，则会自动加载框架的调试配置文件（位于ThinkPHP/Conf/debug.php）和应用调试配置文件（位于Application/Common/Conf/debug.php）</p>
<h3 id="状态配置（可选）"><a href="#状态配置（可选）" class="headerlink" title="状态配置（可选）"></a>状态配置（可选）</h3><p>每个应用都可以在不同的情况下设置自己的状态（或者称之为应用场景），并且加载不同的配置文件。</p>
<p>举个例子，你需要在公司和家里分别设置不同的数据库测试环境。那么可以这样处理，在公司环境中，我们在入口文件中定义：</p>
<p>define(‘APP_STATUS’,’office’);<br>那么就会自动加载该状态对应的配置文件（位于Application/Common/Conf/office.php）。</p>
<p>如果我们回家后，我们修改定义为：</p>
<p>define(‘APP_STATUS’,’home’);<br>那么就会自动加载该状态对应的配置文件（位于Application/Common/Conf/home.php）。</p>
<p>状态配置文件是可选的</p>
<h3 id="模块配置"><a href="#模块配置" class="headerlink" title="模块配置"></a>模块配置</h3><p>每个模块会自动加载自己的配置文件（位于Application/当前模块名/Conf/config.php）。</p>
<p>如果使用了普通模式之外的其他应用模式，你还可以为应用模式单独定义配置文件，命名规范为： Application/当前模块名/Conf/config_应用模式名称.php（仅在运行该模式下面才会加载）。</p>
<p>模块还可以支持独立的状态配置文件，命名规范为： Application/当前模块名/Conf/应用状态.php。</p>
<p>如果你的应用的配置文件比较大，想分成几个单独的配置文件或者需要加载额外的配置文件的话，可以考虑采用扩展配置或者动态配置（参考后面的描述）。</p>
<p>无论何种配置文件，定义了配置文件之后，都统一使用系统提供的C方法（可以借助Config单词来帮助记忆）来读取已有的配置。</p>
<p>用法：</p>
<blockquote>
<p>C(‘参数名称’)</p>
</blockquote>
<p>例如，读取当前的URL模式配置参数：</p>
<p>$model = C(‘URL_MODEL’);<br>// 由于配置参数不区分大小写，因此下面的写法是等效的<br>// $model = C(‘url_model’);<br>但是建议使用大写方式的规范。</p>
<p>注意：配置参数名称中不能含有 “.” 和特殊字符，允许字母、数字和下划线。<br>如果url_model尚未存在设置，则返回NULL。</p>
<p>支持在读取的时候设置默认值，例如：</p>
<p>// 如果my_config尚未设置的话，则返回default_config字符串<br>C(‘my_config’,null,’default_config’);<br>C方法也可以用于读取二维配置：</p>
<p>//获取用户配置中的用户类型设置<br>C(‘USER_CONFIG.USER_TYPE’);<br>因为配置参数是全局有效的，因此C方法可以在任何地方读取任何配置，即使某个设置参数已经生效过期了。</p>
<h2 id="七-架构"><a href="#七-架构" class="headerlink" title="七.架构"></a>七.架构</h2><p><a href="http://www.kancloud.cn/manual/thinkphp/1696" target="_blank" rel="external">模块化设计</a></p>
<h3 id="REWRITE模式"><a href="#REWRITE模式" class="headerlink" title="REWRITE模式"></a>REWRITE模式</h3><p>REWRITE模式是在PATHINFO模式的基础上添加了重写规则的支持，可以去掉URL地址里面的入口文件index.php，但是需要额外配置WEB服务器的重写规则。</p>
<p>如果是Apache则需要在入口文件的同级添加.htaccess文件，内容如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;IfModule mod_rewrite.c&gt;</div><div class="line"> RewriteEngine on</div><div class="line"> RewriteCond %&#123;REQUEST_FILENAME&#125; !-d</div><div class="line"> RewriteCond %&#123;REQUEST_FILENAME&#125; !-f</div><div class="line"> RewriteRule ^(.*)$ index.php/$1 [QSA,PT,L]</div><div class="line">&lt;/IfModule&gt;</div></pre></td></tr></table></figure></p>
<p>接下来，就可以用下面的URL地址访问了： <a href="http://localhost/home/user/login/var/value" target="_blank" rel="external">http://localhost/home/user/login/var/value</a></p>
<p>更多环境的URL重写支持参考部署部分的URL重写。</p>
<h3 id="视图（View）层"><a href="#视图（View）层" class="headerlink" title="视图（View）层"></a>视图（View）层</h3><p>视图层由模板和模板引擎组成，在模板中可以直接使用PHP代码，模板引擎的设计会在后面讲述，通过驱动也可以支持其他第三方的模板引擎。视图的多层可以简单的通过目录（也就是模板主题）区分，例如：</p>
<p>View/default/User/add.html<br>View/blue/User/add.html<br>复杂一点的多层视图还可以更进一步，采用不同的视图目录来完成，例如：</p>
<p>view 普通视图层目录<br>mobile 手机端访问视图层目录<br>这样做的好处是每个不同的视图层都可以支持不同的模板主题功能。</p>
<p>默认的视图层是View目录，我们可以调整设置如下：</p>
<p>‘DEFAULT_V_LAYER’       =&gt;  ‘Mobile’, // 默认的视图层名称更改为Mobile</p>
<h3 id="控制器（Controller）层"><a href="#控制器（Controller）层" class="headerlink" title="控制器（Controller）层"></a>控制器（Controller）层</h3><p>ThinkPHP的控制器层由核心控制器和业务控制器组成，核心控制器由系统内部的App类完成，负责应用（包括模块、控制器和操作）的调度控制，包括HTTP请求拦截和转发、加载配置等。业务控制器则由用户定义的控制器类完成。多层业务控制器的实现原理和模型的分层类似，例如业务控制器和事件控制器：</p>
<p>Controller/UserController //用于用户的业务逻辑控制和调度<br>Event/UserEvent //用于用户的事件响应操作<br>访问控制器 Home/Controller/UserController.class.php 定义如下：</p>
<p>namespace Home\Controller;<br>use Think\Controller;<br>class UserController extends Controller{<br>}<br>事件控制器 Home/Event/UserEvent.class.php 定义如下：</p>
<p>namespace Home\Event;<br>use Think\Controller;<br>class UserEvent extends Controller{<br>}<br>UserController负责外部交互响应，通过URL请求响应，例如 <a href="http://serverName/User/index,而" target="_blank" rel="external">http://serverName/User/index,而</a> UserEvent负责内部的事件响应，并且只能在内部调用：</p>
<p>A(‘User’,’Event’);<br>默认的访问控制器层是Controller，我们可以调整设置如下：</p>
<p>‘DEFAULT_C_LAYER’       =&gt;  ‘Event’, // 默认的控制器层名称改为Event<br>所以是和外部隔离的。</p>
<p>多层控制器的划分也不是强制的，可以根据应用的需要自由分层。控制器分层里面可以根据需要调用分层模型，也可以调用不同的分层视图（主题）。</p>
<p>在MVC三层中，ThinkPHP并不依赖M或者V，甚至可以只有C或者只有V，这个在ThinkPHP的设计里面是一个很重要的用户体验设计，用户只需要定义视图，在没有C的情况下也能自动识别。</p>
<h2 id="八-模板"><a href="#八-模板" class="headerlink" title="八.模板"></a>八.模板</h2><h3 id="1-变量输出"><a href="#1-变量输出" class="headerlink" title="1.变量输出"></a>1.变量输出</h3><p><a href="http://www.kancloud.cn/manual/thinkphp/1794" target="_blank" rel="external">变量输出</a><br>非数组输出和数组输出</p>
<h4 id="系统变量输出"><a href="#系统变量输出" class="headerlink" title="系统变量输出"></a>系统变量输出</h4><p>普通的模板变量需要首先赋值后才能在模板中输出，但是系统变量则不需要，可以直接在模板中输出，系统变量的输出通常以{$Think 打头，例如：</p>
<p>{$Think.server.script_name} // 输出$_SERVER[‘SCRIPT_NAME’]变量<br>{$Think.session.user_id} // 输出$_SESSION[‘user_id’]变量<br>{$Think.get.pageNumber} // 输出$_GET[‘pageNumber’]变量<br>{$Think.cookie.name}  // 输出$_COOKIE[‘name’]变量<br>支持输出 $_SERVER、$_ENV、 $_POST、 $_GET、 $_REQUEST、$_SESSION和 $_COOKIE变量。</p>
<h4 id="常量输出"><a href="#常量输出" class="headerlink" title="常量输出"></a>常量输出</h4><p>还可以输出常量</p>
<p>{$Think.const.MODULE_NAME}<br>或者直接使用</p>
<p>{$Think.MODULE_NAME}</p>
<h4 id="配置输出"><a href="#配置输出" class="headerlink" title="配置输出"></a>配置输出</h4><p>输出配置参数使用：</p>
<p>{$Think.config.db_charset}<br>{$Think.config.url_model}</p>
<h4 id="语言变量"><a href="#语言变量" class="headerlink" title="语言变量"></a>语言变量</h4><p>输出语言变量可以使用：</p>
<p>{$Think.lang.page_error}<br>{$Think.lang.var_error}</p>
<h3 id="2-使用函数"><a href="#2-使用函数" class="headerlink" title="2.使用函数"></a>2.使用函数</h3><p>我们往往需要对模板输出变量使用函数，可以使用：</p>
<p>{$data.name|md5}<br>编译后的结果是：</p>
<p>&lt;?php echo (md5($data[‘name’])); ?&gt;<br>如果函数有多个参数需要调用，则使用：</p>
<p>变量输出使用的函数可以支持内置的PHP函数或者用户自定义函数，甚至是静态方法。</p>
<h3 id="3-标签库"><a href="#3-标签库" class="headerlink" title="3.标签库"></a>3.标签库</h3><h3 id="4-模板继承"><a href="#4-模板继承" class="headerlink" title="4.模板继承"></a>4.模板继承</h3><p>模板继承是一项更加灵活的模板布局方式，模板继承不同于模板布局，甚至来说，应该在模板布局的上层。模板继承其实并不难理解，就好比类的继承一样，模板也可以定义一个基础模板（或者是布局），并且其中定义相关的区块（block），然后继承（extend）该基础模板的子模板中就可以对基础模板中定义的区块进行重载。</p>
<p>因此，模板继承的优势其实是设计基础模板中的区块（block）和子模板中替换这些区块。</p>
<p>每个区块由<block></block>标签组成。 下面就是基础模板中的一个典型的区块设计（用于设计网站标题）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;block name=&quot;title&quot;&gt;&lt;title&gt;网站标题&lt;/title&gt;&lt;/block&gt;</div></pre></td></tr></table></figure>
<p>block标签必须指定name属性来标识当前区块的名称，这个标识在当前模板中应该是唯一的，block标签中可以包含任何模板内容，包括其他标签和变量，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;block name=&quot;title&quot;&gt;&lt;title&gt;&#123;$web_title&#125;&lt;/title&gt;&lt;/block&gt;</div><div class="line">//你甚至还可以在区块中加载外部文件：</div><div class="line"></div><div class="line">&lt;block name=&quot;include&quot;&gt;&lt;include file=&quot;Public:header&quot; /&gt;&lt;/block&gt;</div><div class="line">//一个模板中可以定义任意多个名称标识不重复的区块，例如下面定义了一个base.html基础模板：</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;</div><div class="line">&lt;block name=&quot;title&quot;&gt;&lt;title&gt;标题&lt;/title&gt;&lt;/block&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">&lt;block name=&quot;menu&quot;&gt;菜单&lt;/block&gt;</div><div class="line">&lt;block name=&quot;left&quot;&gt;左边分栏&lt;/block&gt;</div><div class="line">&lt;block name=&quot;main&quot;&gt;主内容&lt;/block&gt;</div><div class="line">&lt;block name=&quot;right&quot;&gt;右边分栏&lt;/block&gt;</div><div class="line">&lt;block name=&quot;footer&quot;&gt;底部&lt;/block&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<p>然后我们在子模板（其实是当前操作的入口模板）中使用继承：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;extend name=&quot;base&quot; /&gt;</div><div class="line">&lt;block name=&quot;title&quot;&gt;&lt;title&gt;&#123;$title&#125;&lt;/title&gt;&lt;/block&gt;</div><div class="line">&lt;block name=&quot;menu&quot;&gt;</div><div class="line">&lt;a href=&quot;/&quot; &gt;首页&lt;/a&gt;</div><div class="line">&lt;a href=&quot;/info/&quot; &gt;资讯&lt;/a&gt;</div><div class="line">&lt;a href=&quot;/bbs/&quot; &gt;论坛&lt;/a&gt;</div><div class="line">&lt;/block&gt;</div><div class="line">&lt;block name=&quot;left&quot;&gt;&lt;/block&gt;</div><div class="line">&lt;block name=&quot;content&quot;&gt;</div><div class="line">&lt;volist name=&quot;list&quot; id=&quot;vo&quot;&gt;</div><div class="line">&lt;a href=&quot;/new/&#123;$vo.id&#125;&quot;&gt;&#123;$vo.title&#125;&lt;/a&gt;&lt;br/&gt;</div><div class="line"> &#123;$vo.content&#125;</div><div class="line">&lt;/volist&gt;</div><div class="line">&lt;/block&gt;</div><div class="line">&lt;block name=&quot;right&quot;&gt;</div><div class="line"> 最新资讯：</div><div class="line">&lt;volist name=&quot;news&quot; id=&quot;new&quot;&gt;</div><div class="line">&lt;a href=&quot;/new/&#123;$new.id&#125;&quot;&gt;&#123;$new.title&#125;&lt;/a&gt;&lt;br/&gt;</div><div class="line">&lt;/volist&gt;</div><div class="line">&lt;/block&gt;</div><div class="line">&lt;block name=&quot;footer&quot;&gt;</div><div class="line"> @ThinkPHP2012 版权所有</div><div class="line">&lt;/block&gt;</div></pre></td></tr></table></figure>
<p>可以看到，子模板中使用了extend标签定义需要继承的模板，extend标签的用法和include标签一样，你也可以加载其他模板：</p>
<p><extend name="Public:base"><br>或者使用绝对文件路径加载</extend></p>
<p><extend name="./Template/Public/base.html"><br>在当前子模板中，只能定义区块而不能定义其他的模板内容，否则将会直接忽略，并且只能定义基础模板中已经定义的区块。</extend></p>
<p>例如，如果采用下面的定义：</p>
<p><block name="title"><title>{$title}</title></block><br><a href="/">首页</a><br><a href="/info/">资讯</a><br><a href="/bbs/">论坛</a><br>导航部分将是无效的，不会显示在模板中。</p>
<p>在子模板中，可以对基础模板中的区块进行重载定义，如果没有重新定义的话，则表示沿用基础模板中的区块定义，如果定义了一个空的区块，则表示删除基础模板中的该区块内容。 上面的例子，我们就把left区块的内容删除了，其他的区块都进行了重载。</p>
<p>子模板中的区块定义顺序是随意的，模板继承的用法关键在于基础模板如何布局和设计规划了，如果结合原来的布局功能，则会更加灵活。</p>
<h3 id="5-包含文件"><a href="#5-包含文件" class="headerlink" title="5.包含文件"></a>5.包含文件</h3><p>在当前模版文件中包含其他的模版文件使用include标签，标签用法：</p>
<include file="模版表达式或者模版文件1,模版表达式或者模版文件2,...">

<h4 id="使用模版表达式"><a href="#使用模版表达式" class="headerlink" title="使用模版表达式"></a>使用模版表达式</h4><p>模版表达式的定义规则为：模块@主题/控制器/操作</p>
<p>例如：</p>
<p><include file="Public/header"> // 包含头部模版header</include></p>
<p><include file="Public/menu"> // 包含菜单模版menu</include></p>
<p><include file="Blue/Public/menu"> // 包含blue主题下面的menu模版<br>可以一次包含多个模版，例如：</include></p>
<p><include file="Public/header,Public/menu"><br>注意，包含模版文件并不会自动调用控制器的方法，也就是说包含的其他模版文件中的变量赋值需要在当前操作中完成。</include></p>
<h4 id="使用模版文件"><a href="#使用模版文件" class="headerlink" title="使用模版文件"></a>使用模版文件</h4><p>可以直接包含一个模版文件名（包含完整路径），例如：</p>
<include file="./Application/Home/View/default/Public/header.html">

<h4 id="传入参数"><a href="#传入参数" class="headerlink" title="传入参数"></a>传入参数</h4><p>无论你使用什么方式包含外部模板，Include标签支持在包含文件的同时传入参数，例如，下面的例子我们在包含header模板的时候传入了title和keywords变量：</p>
<p><include file="Public/header" title="ThinkPHP框架" keywords="开源WEB开发框架"><br>就可以在包含的header.html文件里面使用title和keywords变量，如下：</include></p>
<p><html xmlns="http://www.w3.org/1999/xhtml"></html></p>
<p><head></head></p>
<p><title>[title]</title></p>
<p><meta name="keywords" content="[keywords]"><br><br>注意：由于模板解析的特点，从入口模板开始解析，如果外部模板有所更改，模板引擎并不会重新编译模板，除非在调试模式下或者缓存已经过期。如果部署模式下修改了包含的外部模板文件后，需要把模块的缓存目录清空，否则无法生效。</p>
<h3 id="6-内置标签"><a href="#6-内置标签" class="headerlink" title="6.内置标签"></a>6.内置标签</h3><p><a href="http://www.kancloud.cn/manual/thinkphp/1804" target="_blank" rel="external">内置标签</a></p>
<ul>
<li><p>Volist标签<br>volist标签通常用于查询数据集（select方法）的结果输出，通常模型的select方法返回的结果是一个二维数组，可以直接使用volist标签进行输出。</p>
</li>
<li><p>Foreach标签<br>foreach标签类似与volist标签，只是更加简单，没有太多额外的属性</p>
</li>
<li><p>For标签<br>用法：</p>
</li>
</ul>
<p><for start="开始值" end="结束值" comparison="" step="步进值" name="循环变量名"><br></for><br>开始值、结束值、步进值和循环变量都可以支持变量，开始值和结束值是必须，其他是可选。comparison 的默认值是lt；name的默认值是i，步进值的默认值是1</p>
<ul>
<li>Switch标签</li>
</ul>
<ul>
<li>比较标签<br>比较标签用于简单的变量比较，复杂的判断条件可以用if标签替换，比较标签是一组标签的集合</li>
</ul>
<ul>
<li><p>范围判断标签<br>范围判断标签包括in notin between notbetween四个标签，都用于判断变量是否中某个范围。</p>
</li>
<li><p>IF标签<br>由于if标签的condition属性里面基本上使用的是php语法，尽可能使用判断标签和Switch标签会更加简洁，原则上来说，能够用switch和比较标签解决的尽量不用if标签完成。</p>
</li>
<li><p>Present标签<br>present标签用于判断某个变量是否已经定义</p>
</li>
<li><p>Empty标签<br>empty标签用于判断某个变量是否为空</p>
</li>
<li><p>Defined标签<br>DEFINED标签用于判断某个常量是否有定义</p>
</li>
<li><p>Assign标签<br>ASSIGN标签用于在模板文件中赋值变量，用法如下：</p>
</li>
</ul>
<p><assign name="var" value="123"><br>在运行模板的时候，赋值了一个var的变量，值是123。</assign></p>
<ul>
<li>Define标签<br>DEFINE标签用于中模板中定义常量，用法如下：</li>
</ul>
<p><define name="MY_DEFINE_NAME" value="3"><br>在运行模板的时候，就会定义一个MY_DEFINE_NAME的常量。</define></p>
<ul>
<li>标签嵌套<br>模板引擎支持标签的多层嵌套功能，可以对标签库的标签指定可以嵌套。</li>
</ul>
<p>系统内置的标签中，volist、switch、if、elseif、else、foreach、compare（包括所有的比较标签）、（not）present、（not）empty、（not）defined等标签都可以嵌套使用。例如：</p>
<p><volist name="list" id="vo"><br>    <volist name="vo['sub']" id="sub"><br>        {$sub.name}<br>    </volist><br></volist><br>上面的标签可以用于输出双重循环。</p>
<p>嵌套层次是由标签库中的标签定义的时候的level属性决定的。</p>
<ul>
<li><p>import标签</p>
</li>
<li><p>使用PHP代码</p>
</li>
</ul>
<h3 id="7-原样输出"><a href="#7-原样输出" class="headerlink" title="7.原样输出"></a>7.原样输出</h3><h3 id="8-模板注释"><a href="#8-模板注释" class="headerlink" title="8.模板注释"></a>8.模板注释</h3><h3 id="9-模板布局"><a href="#9-模板布局" class="headerlink" title="9.模板布局"></a>9.模板布局</h3><h3 id="10-模板替换"><a href="#10-模板替换" class="headerlink" title="10.模板替换"></a>10.模板替换</h3><p>在进行模板渲染之前，系统还会对读取的模板内容进行一些特殊字符串替换操作，也就是实现了模板输出的替换和过滤。该替换操作仅针对内置的模版引擎。</p>
<p>这个机制可以使得模板文件的定义更加方便，默认的替换规则有：</p>
<p><strong>ROOT</strong>： 会替换成当前网站的地址（不含域名）<br><strong>APP</strong>： 会替换成当前应用的URL地址 （不含域名）<br><strong>MODULE</strong>：会替换成当前模块的URL地址 （不含域名）<br><strong>CONTROLLER</strong>（<strong>或者</strong>URL<strong> 兼容考虑）： 会替换成当前控制器的URL地址（不含域名）
</strong>ACTION<strong>：会替换成当前操作的URL地址 （不含域名）
</strong>SELF<strong>： 会替换成当前的页面URL
</strong>PUBLIC__：会被替换成当前网站的公共目录 通常是 /Public/<br>默认情况下，模板替换只会替换模板文件的特殊字符串，不会替换动态数据中的输出的内容。</p>
</include></include>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://wellwellrightbaby.github.io/2017/04/25/thinkphp/" data-id="cj3kxw31z0009jcfbzh05ji1u" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/04/17/bootstrap/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Bootstrap
        
      </div>
    </a>
  
  
    <a href="/2017/04/26/ThinkPhp3.1快速入门/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ThinkPhp3.1快速入门</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Bootstrap/">Bootstrap</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ThinkPhp/">ThinkPhp</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/css3/">css3</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jquery/">jquery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/vue/">vue</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/日志/">日志</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/日志/二级目录/">二级目录</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/格式/">格式</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/粤嵌培训/">粤嵌培训</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/hello/">hello</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/hello/" style="font-size: 10px;">hello</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/05/30/ajax/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/05/25/css3/">css3</a>
          </li>
        
          <li>
            <a href="/2017/05/14/css/">(no title)</a>
          </li>
        
          <li>
            <a href="/2017/05/11/jqueryhtml/">jquery</a>
          </li>
        
          <li>
            <a href="/2017/05/10/jquery/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Shevon Liao<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>